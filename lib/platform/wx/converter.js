const fs=require("fs"),gulp=require("gulp"),replace=require("gulp-replace"),config=require("../../config"),diffTag=require("../diff/index").diffTag("wx"),logger=require("../../utils/logger");function convert(e={}){const g=e.source||"./src",s=e.target||"./wx",p=e.assets||config.getAssets(g);gulp.src(p).pipe(gulp.dest(s)).on("end",()=>{logger.info("资源拷贝完成！")}),gulp.src(`${g}/**/*.wxss`).pipe(replace(/[\s\S]*/g,diffTag)).pipe(gulp.dest(s)).on("end",()=>{logger.info("微信：wxss文件编译完成！")}),gulp.src(`${g}/**/*.wxml`).pipe(replace(/[\s\S]*/g,diffTag)).pipe(gulp.dest(s)).on("end",()=>{logger.info("微信：wxml文件编译完成！")});const o=`${s}/project.config.json`,r=[`${g}/**/*.json`];fs.stat(o,e=>{e&&r.push(`!${g}/project.config.json`),gulp.src(r).pipe(gulp.dest(s)).on("end",()=>{logger.info("微信：json文件编译完成！")})}),gulp.src(`${g}/**/*.js`).pipe(replace(/[\s\S]*/g,diffTag)).pipe(gulp.dest(s)).on("end",()=>{logger.info("微信：js文件编译完成！")})}module.exports=convert;